<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Average Calculator | School Tools Hub</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");

      :root {
        --primary: #58a6ff;
        --primary-hover: #1f6feb;
        --bg-dark: #0d1117;
        --bg-card: #161b22;
        --text-light: #c9d1d9;
        --text-muted: #8b949e;
        --border: #30363d;
        --shadow: rgba(88, 166, 255, 0.2);
        --danger: #f85149;
        --success: #56d364;
        --warning: #e3b341;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Poppins", sans-serif;
        background: var(--bg-dark);
        color: var(--text-light);
        padding: 20px;
        transition: all 0.3s ease;
      }

      .theme-toggle {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: 1px solid var(--border);
        color: var(--text-light);
        padding: 8px 12px;
        border-radius: 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
      }

      .theme-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .container {
        max-width: 800px;
        margin: 40px auto;
        background: var(--bg-card);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        border: 1px solid var(--border);
      }

      .back-btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: var(--text-muted);
        text-decoration: none;
        margin-bottom: 20px;
        transition: all 0.3s ease;
      }

      .back-btn:hover {
        color: var(--primary);
      }

      h1 {
        text-align: center;
        color: var(--primary);
        margin-bottom: 10px;
        font-size: 2.2rem;
      }

      .description {
        text-align: center;
        color: var(--text-muted);
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .info-box {
        background: rgba(88, 166, 255, 0.1);
        border: 1px solid var(--primary);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 25px;
        font-size: 0.9rem;
        line-height: 1.6;
      }

      .info-box h3 {
        color: var(--primary);
        margin-bottom: 8px;
        font-size: 1.1rem;
      }

      .form-group {
        display: grid;
        grid-template-columns: 1fr 1fr 100px;
        gap: 15px;
        margin-bottom: 25px;
        align-items: center;
      }

      .form-group input,
      .form-group select {
        padding: 12px 15px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--bg-dark);
        color: var(--text-light);
        font-family: "Poppins", sans-serif;
        transition: all 0.3s ease;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 2px var(--shadow);
      }

      .form-group button {
        padding: 12px;
        border-radius: 8px;
        border: none;
        background: var(--primary);
        color: white;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
      }

      .form-group button:hover {
        background: var(--primary-hover);
      }

      .subjects-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 25px;
      }

      .subjects-table th,
      .subjects-table td {
        padding: 12px;
        text-align: center;
        border: 1px solid var(--border);
      }

      .subjects-table th {
        background: rgba(88, 166, 255, 0.1);
        font-weight: 600;
      }

      .subjects-table tr {
        transition: all 0.3s ease;
      }

      .subjects-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      .action-btn {
        background: transparent;
        border: none;
        color: var(--text-muted);
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
        transition: all 0.3s ease;
        margin: 0 3px;
      }

      .edit-btn:hover {
        color: var(--warning);
      }

      .delete-btn:hover {
        color: var(--danger);
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 25px;
      }

      .action-buttons button {
        flex: 1;
        padding: 12px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 500;
      }

      .calculate-btn {
        background: var(--primary);
        color: white;
      }

      .calculate-btn:hover {
        background: var(--primary-hover);
      }

      .reset-btn {
        background: rgba(248, 81, 73, 0.1);
        color: var(--danger);
        border: 1px solid var(--danger);
      }

      .reset-btn:hover {
        background: rgba(248, 81, 73, 0.2);
      }

      .result {
        text-align: center;
        padding: 20px;
        border-radius: 8px;
        background: rgba(88, 166, 255, 0.1);
        margin-bottom: 25px;
        transition: all 0.3s ease;
        border: 1px solid var(--primary);
      }

      .result h2 {
        color: var(--primary);
        margin-bottom: 10px;
        font-size: 1.8rem;
      }

      .result p {
        color: var(--text-muted);
        margin-bottom: 15px;
      }

      .result-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary);
      }

      .chart-container {
        height: 200px;
        margin-top: 20px;
        position: relative;
      }

      .chart-bar {
        position: absolute;
        bottom: 0;
        width: 40px;
        background: var(--primary);
        border-radius: 4px 4px 0 0;
        transition: all 0.5s ease;
      }

      .chart-label {
        position: absolute;
        bottom: -25px;
        text-align: center;
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .empty-state {
        text-align: center;
        padding: 30px;
        color: var(--text-muted);
      }

      .empty-state p {
        margin-bottom: 15px;
      }

      footer {
        text-align: center;
        margin-top: 40px;
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background: var(--bg-card);
        padding: 25px;
        border-radius: 12px;
        width: 90%;
        max-width: 500px;
        border: 1px solid var(--border);
      }

      .modal h2 {
        margin-bottom: 20px;
        color: var(--primary);
      }

      .modal-form-group {
        margin-bottom: 15px;
      }

      .modal-form-group label {
        display: block;
        margin-bottom: 8px;
        color: var(--text-muted);
      }

      .modal-form-group input,
      .modal-form-group select {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--bg-dark);
        color: var(--text-light);
      }

      .modal-buttons {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        margin-top: 20px;
      }

      .modal-buttons button {
        padding: 10px 15px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .modal-save {
        background: var(--primary);
        color: white;
      }

      .modal-save:hover {
        background: var(--primary-hover);
      }

      .modal-cancel {
        background: transparent;
        color: var(--text-muted);
        border: 1px solid var(--border);
      }

      .modal-cancel:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      .warning-box {
        background: rgba(227, 179, 65, 0.1);
        border: 1px solid var(--warning);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 25px;
        font-size: 0.9rem;
        line-height: 1.6;
      }

      .warning-box h3 {
        color: var(--warning);
        margin-bottom: 8px;
        font-size: 1.1rem;
      }

      /* Light theme */
      body.light-theme {
        --primary: #0066cc;
        --primary-hover: #0052a3;
        --bg-dark: #f5f8fa;
        --bg-card: #ffffff;
        --text-light: #24292e;
        --text-muted: #586069;
        --border: #e1e4e8;
        --shadow: rgba(0, 102, 204, 0.2);
        --danger: #d73a49;
        --success: #28a745;
        --warning: #f1c40f;
      }

      @media (max-width: 768px) {
        .form-group {
          grid-template-columns: 1fr;
        }

        .container {
          padding: 20px;
        }

        h1 {
          font-size: 1.8rem;
        }

        .result-value {
          font-size: 2rem;
        }
      }

      :root {
        --primary: #58a6ff;
        --primary-hover: #1f6feb;
        --bg-dark: #0d1117;
        --bg-card: #161b22;
        --text-light: #c9d1d9;
        --text-muted: #8b949e;
        --border: #30363d;
        --shadow: rgba(88, 166, 255, 0.2);
        --danger: #f85149;
        --success: #56d364;
        --warning: #e3b341;
      }

      /* Hamburger Menu Styles */
      .hamburger-menu {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1000;
        cursor: pointer;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .hamburger-menu:hover {
        border-color: var(--primary);
      }

      .hamburger-icon {
        width: 24px;
        height: 24px;
        position: relative;
      }

      .hamburger-icon span {
        display: block;
        position: absolute;
        height: 2px;
        width: 100%;
        background: var(--text-light);
        border-radius: 2px;
        opacity: 1;
        left: 0;
        transform: rotate(0deg);
        transition: all 0.3s ease;
      }

      .hamburger-icon span:nth-child(1) {
        top: 6px;
      }

      .hamburger-icon span:nth-child(2),
      .hamburger-icon span:nth-child(3) {
        top: 12px;
      }

      .hamburger-icon span:nth-child(4) {
        top: 18px;
      }

      .hamburger-menu.open .hamburger-icon span:nth-child(1),
      .hamburger-menu.open .hamburger-icon span:nth-child(4) {
        width: 0%;
        left: 50%;
        opacity: 0;
      }

      .hamburger-menu.open .hamburger-icon span:nth-child(2) {
        transform: rotate(45deg);
      }

      .hamburger-menu.open .hamburger-icon span:nth-child(3) {
        transform: rotate(-45deg);
      }

      .nav-menu {
        position: fixed;
        top: 0;
        left: -300px;
        width: 300px;
        height: 100%;
        background: var(--bg-card);
        border-right: 1px solid var(--border);
        z-index: 999;
        transition: all 0.3s ease;
        overflow-y: auto;
        padding: 50px 20px 20px;
      }

      .nav-menu.open {
        left: 0;
      }

      .nav-menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 998;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .nav-menu-overlay.open {
        opacity: 1;
        visibility: visible;
      }

      .nav-menu-title {
        font-size: 1.2rem;
        color: var(--primary);
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border);
      }

      .nav-menu-list {
        list-style-type: none;
      }

      .nav-menu-item {
        margin-bottom: 10px;
      }

      .nav-menu-link {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        border-radius: 8px;
        color: var(--text-light);
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .nav-menu-link:hover {
        background: rgba(88, 166, 255, 0.1);
      }

      .nav-menu-link.active {
        background: var(--primary);
        color: white;
      }

      .nav-menu-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Theme Toggle Button */
      .theme-toggle {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: 1px solid var(--border);
        color: var(--text-light);
        padding: 8px 12px;
        border-radius: 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        z-index: 100;
      }

      .theme-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      /* Toast Notification Styles */
      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        border-radius: 8px;
        color: white;
        font-size: 0.9rem;
        z-index: 1000;
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }

      .toast.success {
        background: var(--success);
      }

      .toast.error {
        background: var(--danger);
      }

      .toast.warning {
        background: var(--warning);
      }

      .toast.show {
        opacity: 1;
        transform: translateY(0);
      }

      .toast-icon {
        font-size: 1.2rem;
      }

      .toast-message {
        flex: 1;
      }

      .toast-close {
        background: transparent;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 1.2rem;
        opacity: 0.7;
        transition: opacity 0.3s ease;
      }

      .toast-close:hover {
        opacity: 1;
      }

      /* Footer Styles */
      footer {
        text-align: center;
        margin-top: 40px;
        color: var(--text-muted);
        font-size: 0.9rem;
        padding: 20px 0;
        border-top: 1px solid var(--border);
      }

      .social-links {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 10px;
      }

      .social-link {
        color: var(--text-muted);
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .social-link:hover {
        color: var(--primary);
      }

      /* Light theme */
      body.light-theme {
        --primary: #0066cc;
        --primary-hover: #0052a3;
        --bg-dark: #f5f8fa;
        --bg-card: #ffffff;
        --text-light: #24292e;
        --text-muted: #586069;
        --border: #e1e4e8;
        --shadow: rgba(0, 102, 204, 0.2);
        --danger: #d73a49;
        --success: #28a745;
        --warning: #f1c40f;
      }

      /* Responsive styles */
      @media (max-width: 768px) {
        .hamburger-menu {
          top: 15px;
          left: 15px;
        }

        .theme-toggle {
          top: 15px;
          right: 15px;
          padding: 6px 10px;
          font-size: 0.9rem;
        }
      }

      @media (max-width: 480px) {
        .hamburger-menu {
          top: 10px;
          left: 10px;
          width: 35px;
          height: 35px;
        }

        .theme-toggle {
          top: 10px;
          right: 10px;
          padding: 5px 8px;
          font-size: 0.8rem;
        }

        .nav-menu {
          width: 250px;
          left: -250px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Hamburger Menu -->
    <div class="hamburger-menu" id="hamburgerMenu">
      <div class="hamburger-icon">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-menu" id="navMenu">
      <h2 class="nav-menu-title">School Tools Hub</h2>
      <ul class="nav-menu-list">
        <li class="nav-menu-item">
          <a href="gwa_calculator.html" class="nav-menu-link">
            <span>GWA Calculator</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="general_average_counter.html" class="nav-menu-link">
            <span>General Average</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="pomodoro_timer.html" class="nav-menu-link">
            <span>Pomodoro Timer</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="unit_converter.html" class="nav-menu-link">
            <span>Unit Converter</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="dictionary.html" class="nav-menu-link">
            <span>Dictionary</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="word_counter.html" class="nav-menu-link">
            <span>Word Counter</span>
          </a>
        </li>

        <li class="nav-menu-item">
          <a href="typing_test.html" class="nav-menu-link">
            <span>Typing Test</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="readability_checker.html" class="nav-menu-link">
            <span>Readability Checker</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="citation_generator.html" class="nav-menu-link">
            <span>Citation Generator</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="text_case_converter.html" class="nav-menu-link">
            <span>Text Case Converter</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="physics_calculator.html" class="nav-menu-link">
            <span>Physics Calculator</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="bmi_calculator.html" class="nav-menu-link">
            <span>BMI Calculator</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="statistical_calculator.html" class="nav-menu-link">
            <span>Statistical Calculator</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="trigonometry_solver.html" class="nav-menu-link">
            <span>Trigonometry Solver</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="data_sorting.html" class="nav-menu-link">
            <span>Data Sorting</span>
          </a>
        </li>
        <li class="nav-menu-item">
          <a href="metadata_viewer.html" class="nav-menu-link">
            <span>Metadata Viewer</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav-menu-overlay" id="navMenuOverlay"></div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
      <div class="toast-icon" id="toastIcon"></div>
      <div class="toast-message" id="toastMessage"></div>
      <button class="toast-close" id="toastClose">×</button>
    </div>

    <button class="theme-toggle" onclick="toggleTheme()">
      <span id="theme-icon">🌙</span> <span id="theme-text">Dark Mode</span>
    </button>

    <div class="container">
      <a href="../index.html" class="back-btn"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="24"
          height="24"
          color="#d3d3d3"
          fill="none">
          <path
            d="M15 6C15 6 9.00001 10.4189 9 12C8.99999 13.5812 15 18 15 18"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        Back to Home</a
      >

      <h1>General Average Calculator</h1>
      <p class="description"
        >Calculate your overall percentage average across all subjects.</p
      >

      <div class="info-box">
        <h3>About General Average Calculation</h3>
        <p
          >This calculator computes your overall average by adding all your
          subject grades (75-100) and dividing by the number of subjects.</p
        >
        <p style="text-align: center; margin: 10px 0; font-weight: 500"
          >General Average = Sum of all grades ÷ Number of subjects</p
        >
      </div>

      <div class="warning-box">
        <h3>Important Note</h3>
        <p
          >Only enter grades between 75 and 100. Grades below 75 will not be
          included in the calculation.</p
        >
      </div>

      <div class="form-group">
        <input type="text" id="subjectName" placeholder="Subject Name" />
        <input
          type="number"
          id="subjectGrade"
          placeholder="Grade (75-100)"
          min="75"
          max="100"
          step="0.01" />
        <button onclick="addSubject()">Add</button>
      </div>

      <div id="tableContainer">
        <div id="emptyState" class="empty-state">
          <p>No subjects added yet.</p>
          <p
            >Add subjects using the form above to calculate your general
            average.</p
          >
        </div>

        <table id="subjectsTable" class="subjects-table" style="display: none">
          <thead>
            <tr>
              <th>Subject</th>
              <th>Grade</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="subjectsBody"></tbody>
        </table>
      </div>

      <div class="action-buttons">
        <button class="reset-btn" onclick="resetCalculator()">Reset All</button>
        <button class="calculate-btn" onclick="calculateAverage()"
          >Calculate Average</button
        >
      </div>

      <div id="result" class="result" style="display: none">
        <h2>Your General Average Result</h2>
        <p>Based on <span id="subjectCount">0</span> subjects</p>
        <div class="result-value" id="averageValue">0.00</div>

        <div id="chartContainer" class="chart-container"></div>
      </div>
    </div>

    <!-- Edit Subject Modal -->
    <div id="editModal" class="modal">
      <div class="modal-content">
        <h2>Edit Subject</h2>
        <div class="modal-form-group">
          <label for="editSubjectName">Subject Name</label>
          <input type="text" id="editSubjectName" />
        </div>
        <div class="modal-form-group">
          <label for="editSubjectGrade">Grade (75-100)</label>
          <input
            type="number"
            id="editSubjectGrade"
            min="75"
            max="100"
            step="0.01" />
        </div>
        <div class="modal-buttons">
          <button class="modal-cancel" onclick="closeEditModal()"
            >Cancel</button
          >
          <button class="modal-save" onclick="saveEditSubject()"
            >Save Changes</button
          >
        </div>
      </div>
    </div>

    <footer id="footer-placeholder"></footer>

    <script>
      // Initialize subjects array and current edit index
      let subjects = [];
      let currentEditIndex = -1;

      // Load saved data from localStorage if available
      document.addEventListener("DOMContentLoaded", function () {
        loadSavedData();
        updateThemeToggle();
      });

      // Theme toggle functionality
      function toggleTheme() {
        document.body.classList.toggle("light-theme");
        const isLight = document.body.classList.contains("light-theme");
        localStorage.setItem("theme", isLight ? "light" : "dark");
        updateThemeToggle();
      }

      function updateThemeToggle() {
        const isLight = document.body.classList.contains("light-theme");
        document.getElementById("theme-icon").textContent = isLight
          ? "☀️"
          : "🌙";
        document.getElementById("theme-text").textContent = isLight
          ? "Light Mode"
          : "Dark Mode";
      }

      // Load saved theme preference
      const savedTheme = localStorage.getItem("theme") || "dark";
      document.body.classList.toggle("light-theme", savedTheme === "light");

      // Load saved subjects data
      function loadSavedData() {
        const savedSubjects = localStorage.getItem("generalAverageSubjects");
        if (savedSubjects) {
          subjects = JSON.parse(savedSubjects);
          updateTable();
          if (subjects.length > 0) {
            calculateAverage();
          }
        }
      }

      // Save subjects to localStorage
      function saveData() {
        localStorage.setItem(
          "generalAverageSubjects",
          JSON.stringify(subjects)
        );
      }

      // Add a new subject
      function addSubject() {
        const name = document.getElementById("subjectName").value.trim();
        const gradeInput = document.getElementById("subjectGrade").value;

        if (!name) {
          alert("Please enter a subject name.");
          return;
        }

        if (!gradeInput) {
          alert("Please enter a grade.");
          return;
        }

        const grade = Number(gradeInput);
        if (isNaN(grade) || grade < 75 || grade > 100) {
          alert("Please enter a valid grade between 75 and 100.");
          return;
        }

        subjects.push({ name, grade });

        // Update the table and save data
        updateTable();
        saveData();

        // Clear input fields
        document.getElementById("subjectName").value = "";
        document.getElementById("subjectGrade").value = "";
      }

      // Update the subjects table
      function updateTable() {
        const tableContainer = document.getElementById("tableContainer");
        const emptyState = document.getElementById("emptyState");
        const table = document.getElementById("subjectsTable");
        const tbody = document.getElementById("subjectsBody");

        // Show/hide empty state based on subjects array
        if (subjects.length === 0) {
          emptyState.style.display = "block";
          table.style.display = "none";
          return;
        } else {
          emptyState.style.display = "none";
          table.style.display = "table";
        }

        // Clear existing rows
        tbody.innerHTML = "";

        // Add rows for each subject
        subjects.forEach((subject, index) => {
          const row = tbody.insertRow();

          // Subject name cell
          const nameCell = row.insertCell(0);
          nameCell.textContent = subject.name;

          // Grade cell
          const gradeCell = row.insertCell(1);
          gradeCell.textContent = subject.grade.toFixed(2);

          // Actions cell
          const actionsCell = row.insertCell(2);
          actionsCell.innerHTML = `
          <button class="action-btn edit-btn" onclick="editSubject(${index})"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="currentColor" fill="none">
    <path d="M16.4249 4.60509L17.4149 3.6151C18.2351 2.79497 19.5648 2.79497 20.3849 3.6151C21.205 4.43524 21.205 5.76493 20.3849 6.58507L19.3949 7.57506M16.4249 4.60509L9.76558 11.2644C9.25807 11.772 8.89804 12.4078 8.72397 13.1041L8 16L10.8959 15.276C11.5922 15.102 12.228 14.7419 12.7356 14.2344L19.3949 7.57506M16.4249 4.60509L19.3949 7.57506" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round" />
    <path d="M18.9999 13.5C18.9999 16.7875 18.9999 18.4312 18.092 19.5376C17.9258 19.7401 17.7401 19.9258 17.5375 20.092C16.4312 21 14.7874 21 11.4999 21H11C7.22876 21 5.34316 21 4.17159 19.8284C3.00003 18.6569 3 16.7712 3 13V12.5C3 9.21252 3 7.56879 3.90794 6.46244C4.07417 6.2599 4.2599 6.07417 4.46244 5.90794C5.56879 5 7.21252 5 10.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
</svg>
</button>
          <button class="action-btn delete-btn" onclick="deleteSubject(${index})"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="red" fill="none">
    <path d="M19.5 5.5L18.8803 15.5251C18.7219 18.0864 18.6428 19.3671 18.0008 20.2879C17.6833 20.7431 17.2747 21.1273 16.8007 21.416C15.8421 22 14.559 22 11.9927 22C9.42312 22 8.1383 22 7.17905 21.4149C6.7048 21.1257 6.296 20.7408 5.97868 20.2848C5.33688 19.3626 5.25945 18.0801 5.10461 15.5152L4.5 5.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
    <path d="M9 11.7349H15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
    <path d="M10.5 15.6543H13.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
    <path d="M3 5.5H21M16.0555 5.5L15.3729 4.09173C14.9194 3.15626 14.6926 2.68852 14.3015 2.39681C14.2148 2.3321 14.1229 2.27454 14.0268 2.2247C13.5937 2 13.0739 2 12.0343 2C10.9686 2 10.4358 2 9.99549 2.23412C9.89791 2.28601 9.80479 2.3459 9.7171 2.41317C9.32145 2.7167 9.10044 3.20155 8.65842 4.17126L8.05273 5.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
</svg>
</button>
        `;
        });
      }

      // Delete a subject
      function deleteSubject(index) {
        if (confirm("Are you sure you want to delete this subject?")) {
          subjects.splice(index, 1);
          updateTable();
          saveData();

          // Recalculate average if there are still subjects
          if (subjects.length > 0) {
            calculateAverage();
          } else {
            document.getElementById("result").style.display = "none";
          }
        }
      }

      // Open edit modal for a subject
      function editSubject(index) {
        currentEditIndex = index;
        const subject = subjects[index];

        document.getElementById("editSubjectName").value = subject.name;
        document.getElementById("editSubjectGrade").value = subject.grade;

        document.getElementById("editModal").style.display = "flex";
      }

      // Close edit modal
      function closeEditModal() {
        document.getElementById("editModal").style.display = "none";
        currentEditIndex = -1;
      }

      // Save edited subject
      function saveEditSubject() {
        if (currentEditIndex === -1) return;

        const name = document.getElementById("editSubjectName").value.trim();
        const gradeInput = document.getElementById("editSubjectGrade").value;

        if (!name) {
          alert("Please enter a subject name.");
          return;
        }

        if (!gradeInput) {
          alert("Please enter a grade.");
          return;
        }

        const grade = Number(gradeInput);
        if (isNaN(grade) || grade < 75 || grade > 100) {
          alert("Please enter a valid grade between 75 and 100.");
          return;
        }

        subjects[currentEditIndex] = { name, grade };

        updateTable();
        saveData();
        calculateAverage();
        closeEditModal();
      }

      // Calculate average
      function calculateAverage() {
        if (subjects.length === 0) {
          alert("Please add at least one subject.");
          return;
        }

        // Filter out grades below 75
        const validSubjects = subjects.filter((subject) => subject.grade >= 75);

        if (validSubjects.length === 0) {
          alert(
            "No valid grades to calculate average. Only grades between 75 and 100 are included."
          );
          return;
        }

        // Calculate the sum of grades
        let totalGrades = 0;
        validSubjects.forEach((subject) => {
          totalGrades += subject.grade;
        });

        // Calculate average
        const average = totalGrades / validSubjects.length;

        // Update the result display
        document.getElementById("subjectCount").textContent =
          validSubjects.length;
        document.getElementById("averageValue").textContent =
          average.toFixed(2);
        document.getElementById("result").style.display = "block";

        // Generate chart visualization
        generateChart(validSubjects);
      }

      // Generate chart visualization
      function generateChart(validSubjects) {
        const chartContainer = document.getElementById("chartContainer");
        chartContainer.innerHTML = "";

        // Group subjects by grade ranges
        const gradeRanges = {
          "95-100": 0,
          "90-94": 0,
          "85-89": 0,
          "80-84": 0,
          "75-79": 0,
        };

        validSubjects.forEach((subject) => {
          const grade = subject.grade;
          if (grade >= 95) gradeRanges["95-100"]++;
          else if (grade >= 90) gradeRanges["90-94"]++;
          else if (grade >= 85) gradeRanges["85-89"]++;
          else if (grade >= 80) gradeRanges["80-84"]++;
          else if (grade >= 75) gradeRanges["75-79"]++;
        });

        // Find the maximum count for scaling
        const maxCount = Math.max(...Object.values(gradeRanges));

        // Create bars for each range
        let index = 0;
        for (const [range, count] of Object.entries(gradeRanges)) {
          if (count > 0) {
            // Calculate height percentage based on max count
            const heightPercentage = (count / maxCount) * 100;

            // Create bar element
            const bar = document.createElement("div");
            bar.className = "chart-bar";
            bar.style.height = "0%";
            bar.style.left = `${index * 20}%`;
            bar.style.width = "15%";

            // Create label element
            const label = document.createElement("div");
            label.className = "chart-label";
            label.textContent = `${range} (${count})`;
            label.style.width = "15%";
            label.style.left = `${index * 20}%`;

            // Add elements to container
            chartContainer.appendChild(bar);
            chartContainer.appendChild(label);

            // Animate bar height after a small delay
            setTimeout(() => {
              bar.style.height = `${heightPercentage}%`;
            }, 100 * index);

            index++;
          }
        }
      }

      // Reset calculator
      function resetCalculator() {
        if (
          confirm(
            "Are you sure you want to reset the calculator? This will delete all subjects."
          )
        ) {
          subjects = [];
          updateTable();
          saveData();
          document.getElementById("result").style.display = "none";
        }
      }
    </script>
    <script src="/js/script.js"></script>
    <script src="../nav/nav.js"></script>
    <script src="../nav/footer.js"></script>
  </body>
</html>
